-- 1. Funcionários do depto "Vendas" com salário acima de 2500
SELECT f.nome, f.salario
FROM funcionarios f
JOIN departamentos d ON f.departamento_id = d.id
WHERE d.nome = 'Vendas' AND f.salario > 2500;

-- 2. Nome dos funcionários + nome do departamento + projeto
SELECT f.nome AS funcionario, d.nome AS departamento, p.nome AS projeto
FROM funcionarios f
JOIN departamentos d ON f.departamento_id = d.id
JOIN funcionario_projeto fp ON f.id = fp.funcionario_id
JOIN projetos p ON fp.projeto_id = p.id;

-- 3. Salário médio de cada departamento
SELECT d.nome AS departamento, AVG(f.salario) AS salario_medio
FROM funcionarios f
JOIN departamentos d ON f.departamento_id = d.id
GROUP BY d.nome;

-- 4. Departamentos com salário médio > 5000
SELECT d.nome AS departamento, AVG(f.salario) AS salario_medio
FROM funcionarios f
JOIN departamentos d ON f.departamento_id = d.id
GROUP BY d.nome
HAVING AVG(f.salario) > 5000;

-- 5. Quantidade de funcionários em cada projeto
SELECT p.nome AS projeto, COUNT(fp.funcionario_id) AS qtd_funcionarios
FROM projetos p
LEFT JOIN funcionario_projeto fp ON p.id = fp.projeto_id
GROUP BY p.nome;

-- 6. Funcionários + gerente + departamento
SELECT f.nome AS funcionario, g.nome AS gerente, d.nome AS departamento
FROM funcionarios f
LEFT JOIN funcionarios g ON f.gerente_id = g.id
JOIN departamentos d ON f.departamento_id = d.id;

-- 7. Funcionários que participam de mais de 1 projeto
SELECT f.nome AS funcionario, COUNT(fp.projeto_id) AS qtd_projetos
FROM funcionarios f
JOIN funcionario_projeto fp ON f.id = fp.funcionario_id
GROUP BY f.nome
HAVING COUNT(fp.projeto_id) > 1;

-- 8. Projetos sem nenhum funcionário
SELECT p.nome AS projeto
FROM projetos p
LEFT JOIN funcionario_projeto fp ON p.id = fp.projeto_id
WHERE fp.funcionario_id IS NULL;

-- 9. Departamentos + soma dos salários
SELECT d.nome AS departamento, SUM(f.salario) AS total_salarios
FROM funcionarios f
JOIN departamentos d ON f.departamento_id = d.id
GROUP BY d.nome;

-- 10. Funcionários + quantidade de projetos
SELECT f.nome AS funcionario, COUNT(fp.projeto_id) AS qtd_projetos
FROM funcionarios f
LEFT JOIN funcionario_projeto fp ON f.id = fp.funcionario_id
GROUP BY f.nome;
